<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>å¹å¥æ¥½ã‚¹ãƒ†ãƒ¼ã‚¸é…ç½®</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>

<style>
body{
  margin:0;
  display:flex;
  font-family:sans-serif;
  background:#f0f2f5;
}

/* å·¦ãƒ‘ãƒ¬ãƒƒãƒˆ */
#palette{
  width:220px;
  background:#222;
  color:white;
  padding:10px;
}

.item{
  background:#444;
  margin:8px 0;
  padding:10px;
  cursor:pointer;
  text-align:center;
  border-radius:6px;
}

.item:hover{
  background:#666;
}

/* èˆå° */
#stageArea{
  flex:1;
  padding:10px;
}

canvas{
  background:white;
  border:2px solid #999;
}
</style>
</head>

<body>

<div id="palette">
  <h3>é…ç½®ã‚¢ã‚¤ãƒ†ãƒ </h3>

  <div class="item" onclick="addChair()">ğŸª‘ æ¤…å­</div>
  <div class="item" onclick="addStand()">ğŸ¼ è­œé¢å°</div>
  <div class="item" onclick="addInstrument('ğŸº')">ãƒˆãƒ©ãƒ³ãƒšãƒƒãƒˆ</div>
  <div class="item" onclick="addInstrument('ğŸ·')">ã‚µãƒƒã‚¯ã‚¹</div>
  <div class="item" onclick="addInstrument('ğŸ¥')">æ‰“æ¥½å™¨</div>

  <hr>
  <div class="item" onclick="save()">ä¿å­˜</div>
  <div class="item" onclick="load()">èª­è¾¼</div>
</div>

<div id="stageArea">
  <canvas id="c" width="1000" height="650"></canvas>
</div>

<script>
const canvas = new fabric.Canvas('c',{
  selection:true
});

/* ===== æ¤…å­ ===== */
function addChair(){
  const chair = new fabric.Rect({
    left:100,
    top:100,
    width:35,
    height:35,
    fill:"#8b5a2b",
    rx:5,
    ry:5
  });
  canvas.add(chair);
}

/* ===== è­œé¢å° ===== */
function addStand(){
  const stand = new fabric.Group([
    new fabric.Rect({
      width:30,
      height:20,
      fill:"#333",
      top:-10
    }),
    new fabric.Rect({
      width:4,
      height:40,
      fill:"#333",
      top:10
    })
  ],{
    left:120,
    top:120
  });

  canvas.add(stand);
}

/* ===== æ¥½å™¨ ===== */
function addInstrument(icon){
  const text = new fabric.Text(icon,{
    fontSize:28,
    left:150,
    top:150
  });

  canvas.add(text);
}

/* ===== å‰Šé™¤ã‚­ãƒ¼ ===== */
document.addEventListener("keydown",e=>{
  if(e.key==="Delete"){
    const obj = canvas.getActiveObject();
    if(obj) canvas.remove(obj);
  }
});

/* ===== ä¿å­˜ ===== */
function save(){
  localStorage.setItem(
    "bandStage",
    JSON.stringify(canvas.toJSON())
  );
}

/* ===== èª­è¾¼ ===== */
function load(){
  const data = localStorage.getItem("bandStage");
  if(data){
    canvas.loadFromJSON(data,canvas.renderAll.bind(canvas));
  }
}
</script>

</body>
</html>
